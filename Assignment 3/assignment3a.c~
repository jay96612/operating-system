#include<stdio.h>
#include<sys/types.h>
#include<signal.h>
#include<unistd.h>
#include<stdlib.h>

#define buf 100

void myfunction()
{
        char line[buf];
        int n,PID,PPID,y,k,a=0,b=1,c,p[2],x;

        PID=getpid();
        PPID=getppid();

        printf("Enter the No of terms ");
        scanf("%d",&k);

        if (pipe(p) < 0)
        exit(1);

        n=fork();

        if(n<0)
                printf("Fork system fails\n");
        else
        {
                if(n==0)
                {
                        close(p[0]);
                        while(k--)
                        {
                                //printf("%d ",k);
                                sprintf(line,"%d",a);
                                write(p[1],line,buf);
                                c=a+b;
                                a=b;
                                b=c;
                        }
                }
                         else
                {
                        wait(NULL);
                        close(p[1]);
                        while ((x = read(p[0], line, buf)) > 0)
                        {
                                sscanf(line,"%d",&y);
                                printf("%d ",y);
                        }

                        if (x != 0)
                                exit(2);
                        printf("\nFinished reading\n");
                }
        }
}

int main()
{
        myfunction();
        return 0;

}

